[platformio]
src_dir = main

[env:seeed_xiao_esp32c6]
platform = espressif32
board = seeed-xiao-esp32-c6
framework = espidf

; --- NEW SETTINGS ---
; 1. Tell PlatformIO to look for board definitions in the 'boards' folder
board_dir = boards 

board_build.flash_size = 4MB
board_build.partitions = partitions_singleapp_large.csv

; Apply sdkconfig defaults for size reduction
board_build.embed_txtfiles = 
board_build.cmake_extra_args = 
    -DSDKCONFIG_DEFAULTS=sdkconfig.defaults

; Size optimization flags
build_flags = 
    -Os                          ; Optimize for size
    -DCORE_DEBUG_LEVEL=3         ; Changed to ESP_LOG_INFO (or use 4 for DEBUG, 5 for VERBOSE)
    -ffunction-sections          ; Place each function in its own section
    -fdata-sections              ; Place each data in its own section
    -Wl,--gc-sections            ; Remove unused sections at link time
    -fno-stack-protector         ; Disable stack protection
    -fomit-frame-pointer         ; Omit frame pointer

build_unflags = 
    -fno-exceptions              ; Remove default exception handling
    -fstack-protector

; Monitor configuration
monitor_speed = 115200
monitor_filters = esp32_exception_decoder

; 2. (Optional but recommended) Specify the exact path to the JSON file
;    This is generally not needed if the board name matches the filename,
;    but it can sometimes force the correct lookup.
; board_build.f_cpu = 240000000L  ; Example of an existing board_build setting
; board_build.core = esp32c6
; board_build.mcu = esp32c6